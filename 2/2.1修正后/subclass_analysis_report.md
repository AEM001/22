
# 文物玻璃亚类划分聚类分析报告 (修正版)

## 1. 分析方法与流程概述


本次分析旨在对高钾玻璃和铅钡玻璃进行亚类划分。在初始版本基础上，我们进行了以下修正与优化：

1.  **高钾玻璃离群点处理**: 针对原分析中高钾玻璃出现单样本亚类的问题，我们首先采用 **孤立森林(Isolation Forest)** 算法进行离群点检测。在移除识别出的离群点后，再对剩余样本进行K-Means聚类，以确保亚类划分的稳健性与合理性。
2.  **铅钡玻璃深化分析**: 针对`氧化铅(PbO)`成分在各亚类间"均值差异大但ANOVA检验不显著"的矛盾，我们补充了 **箱线图(Box Plot)** 进行可视化诊断，并引入 **Kruskal-Wallis非参数检验**，从不同统计学角度重新评估其差异性。
3.  **核心流程**: 特征选择、ILR变换、Z-Score标准化、肘部法则确定k值、K-Means聚类、轮廓系数评估等核心流程保持不变。


## 高钾玻璃亚类分析: 离群点检测与修正
使用`孤立森林`算法在ILR变换后的高维特征空间中进行离群点检测。
**检测结果**: 发现 **5** 个潜在离群点 (文物编号: `13`, `14`, `16`, `18`, `21`)。
> **分析**: 该样本在高维空间中与其他高钾玻璃样本疏离，与原始聚类分析中单样本成一类的情况吻合。为提高聚类结果的可靠性，我们将其移除后重新进行聚类分析。
亚类分析将在剩余的 **11** 个高钾样本上进行。


## 高钾玻璃亚类分析
**选定的聚类特征**: `二氧化硅(SiO2), 氧化钾(K2O), 氧化钙(CaO), 氧化铝(Al2O3)`
> **理由**: 基于对该玻璃类型样本的方差分析，这些成分在其内部变化最显著，因此最有可能揭示其存在的亚类结构。


### 亚类数量(k)选择: 肘部法则
根据生成的肘部图，我们选择 **k=2** 作为最佳亚类数进行下一步分析。
![高钾 肘部图](elbow_plot_高钾.png)

### K-Means聚类结果与评估 (k=2)
**聚类效果评估 (轮廓系数)**: **0.3669**
> **说明**: 轮廓系数衡量聚类的紧密性和分离度，其值范围为[-1, 1]。一个接近+1的值表明样本远离相邻簇，聚类效果好；接近0表示样本在簇的边界上；负值则表示样本可能被分到了错误的簇。当前的分数表明聚类结果具有合理的区分度。


**各亚类样本数量:**

```
|   亚类 |   样本数量 |
|-------:|-----------:|
|      0 |          4 |
|      1 |          7 |
```
> **说明**: 上表显示了每个亚类中包含的文物样本数量，有助于我们理解各个亚类的规模和代表性。


**各亚类化学成分中心 (均值):**

```
|   亚类 |   二氧化硅(SiO2) |   氧化钾(K2O) |   氧化钙(CaO) |   氧化铝(Al2O3) |
|-------:|-----------------:|--------------:|--------------:|----------------:|
|      0 |          65.13   |       9.53375 |       5.87375 |         7.1175  |
|      1 |          91.1657 |       1.72    |       1.30857 |         2.33714 |
```
> **说明**: 上表是每个亚类化学成分的**平均值**，它代表了该亚类的“典型”化学构成，是后续对亚类进行命名的核心依据。


**各亚类化学成分标准差:**

```
|   亚类 |   二氧化硅(SiO2) |   氧化钾(K2O) |   氧化钙(CaO) |   氧化铝(Al2O3) |
|-------:|-----------------:|--------------:|--------------:|----------------:|
|      0 |          3.30479 |       1.4454  |       2.15813 |         2.76244 |
|      1 |          7.5691  |       3.13958 |       1.24285 |         1.39124 |
```
> **说明**: 标准差反映了亚类内部成员的离散程度。**数值越小**，代表该亚类内部的样本在这一化学成分上越相似、一致性越高。


### 亚类可视化
![高钾 Pair Plot](pairplot_高钾.png)

## 铅钡玻璃亚类分析
**选定的聚类特征**: `二氧化硅(SiO2), 氧化铅(PbO), 氧化钡(BaO), 五氧化二磷(P2O5)`
> **理由**: 基于对该玻璃类型样本的方差分析，这些成分在其内部变化最显著，因此最有可能揭示其存在的亚类结构。


### 亚类数量(k)选择: 肘部法则
根据生成的肘部图，我们选择 **k=3** 作为最佳亚类数进行下一步分析。
![铅钡 肘部图](elbow_plot_铅钡.png)

### K-Means聚类结果与评估 (k=3)
**聚类效果评估 (轮廓系数)**: **0.3266**
> **说明**: 轮廓系数衡量聚类的紧密性和分离度，其值范围为[-1, 1]。一个接近+1的值表明样本远离相邻簇，聚类效果好；接近0表示样本在簇的边界上；负值则表示样本可能被分到了错误的簇。当前的分数表明聚类结果具有合理的区分度。


**各亚类样本数量:**

```
|   亚类 |   样本数量 |
|-------:|-----------:|
|      0 |         13 |
|      1 |         13 |
|      2 |         14 |
```
> **说明**: 上表显示了每个亚类中包含的文物样本数量，有助于我们理解各个亚类的规模和代表性。


**各亚类化学成分中心 (均值):**

```
|   亚类 |   二氧化硅(SiO2) |   氧化铅(PbO) |   氧化钡(BaO) |   五氧化二磷(P2O5) |
|-------:|-----------------:|--------------:|--------------:|-------------------:|
|      0 |          46.0031 |       30.1    |       7.73038 |            3.78423 |
|      1 |          50.5227 |       25.9862 |       8.47192 |            0.65    |
|      2 |          29.0054 |       40.3046 |      13.5007  |            3.90821 |
```
> **说明**: 上表是每个亚类化学成分的**平均值**，它代表了该亚类的“典型”化学构成，是后续对亚类进行命名的核心依据。


**各亚类化学成分标准差:**

```
|   亚类 |   二氧化硅(SiO2) |   氧化铅(PbO) |   氧化钡(BaO) |   五氧化二磷(P2O5) |
|-------:|-----------------:|--------------:|--------------:|-------------------:|
|      0 |          19.6843 |       13.8314 |       6.74646 |            3.64275 |
|      1 |          11.6264 |       13.3371 |       2.70351 |            1.55175 |
|      2 |          14.8171 |       15.5008 |       9.62008 |            3.45181 |
```
> **说明**: 标准差反映了亚类内部成员的离散程度。**数值越小**，代表该亚类内部的样本在这一化学成分上越相似、一致性越高。


### 亚类可视化
![铅钡 Pair Plot](pairplot_铅钡.png)

### 对氧化铅(PbO)的补充分析
> **背景**: 初始ANOVA检验显示，各亚类间的`氧化铅(PbO)`均值无统计显著性差异（p>0.05），但这与观察到的均值差异（如亚类均值40.3%
vs 26.0%）似乎矛盾。这通常由组内方差过大导致。为进一步探究，我们进行非参数检验和可视化分析。

**可视化分析 (箱线图):**
![铅钡PbO箱线图](boxplot_pbo_qianbei.png)
> **解读**: 箱线图直观地展示了每个亚类的`氧化铅(PbO)`分布。尽管均值有差异，但每个亚类内部的数据分布范围（由箱体和须表示）很广且有大量重叠，这解释
了为何ANOVA检验不显著。特别是亚类2的中位数（箱内横线）最高，但其数据点也较为分散。

**非参数检验 (Kruskal-Wallis H-test):**
> **方法**: Kruskal-
Wallis检验是单因素方差分析(ANOVA)的非参数替代方案，它不要求数据正态分布，而是比较各组的中位数是否存在显著差异，对离群值和方差不齐的情况更具鲁棒性。
- **检验结果**: H统计量 = **5.9239**, p值 = **0.0517**
- **结论**: p值大于或等于0.05，表明**未能拒绝原假设**。从秩分布的角度看，各亚类之间`氧化铅(PbO)`含量的差异不具备统计显著性。
